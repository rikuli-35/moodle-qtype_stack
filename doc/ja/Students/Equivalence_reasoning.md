# 同値変形

STACKでは、方程式や不等式を行ごとに解いていくことができる場合がある。その際、隣接する行が互いに等価となるように計算を進める必要がある。

まず、問題に示された方程式をテキストエリアに入力する。そこから、問題が解けるまで1行ずつ計算を進める。通常、入力中にフィードバックが表示される。

例えば、二次方程式 \\( x^2-4x-5=0\\) を解くには、次のように計算する。

    x^2-4*x-5=0
    (x+1)*(x-5)=0
    x=-1 or x=5

前の行からコピー&ペーストして、その行を書き換えることもできる。

この計算は次のように表示されることがある。

\\[ \\begin{array}{ccc} \\  & x^2-4 x-5=0 & \\text{ } \\\\ \\color{green}{\\Leftrightarrow} & \\left(x+1\\right) \\left(x-5\\right)=0 & \\text{ } \\\\ \\color{green}{\\Leftrightarrow} & x=-1\\lor x=5 & \\text{ } \\end{array} \\]

このフィードバックが表示されるかどうかは、問題の設定によって異なる。このフィードバックは、STACKが各行を前の行と等価であるとみなしていることを示している。最後の行が最終的な解答となるが、計算全体も評価の対象となる。

1. STACKの[解答入力](Answer_input.md)で使用される通常の構文（括弧や掛け算の `*` 記号を含む）を使用する。
2. 同値変形では、集合、リスト、行列は使用できない。
3. 解答をリストや数の集合として入力するのではなく、`x=-1 or x=5` のような論理的な記法を使用する。

方程式だけでなく、式を使って行ごとに計算を進めることもできる。例えば、\\( (x-1)(x+4) \\) を展開するには、次のように計算する。

    (x-1)*(x+4)
    =x^2-x+4*x-4
    =x^2+3*x-4

これは次のように表示されることがある。

\\[\\begin{array}{ll}\\ &\\left(x-1\\right) \\left(x+4\\right) \\cr \\color{green}{\\checkmark}&=x^2-x+4 x-4 \\cr
\\color{green}{\\checkmark}&=x^2+3 x-4\\end{array}\\]

この場合、新しい行は等号 `=` で始める必要がある。

## 「等価」とは何か

2つの*方程式*が等価であるとは、同じ解を同じ重複度で持つことを意味する。

2つの*式*が等価であるとは、変数に値を代入したときに同じ値をとることを意味する。

同値変形を使って方程式を解く際の一般的なアドバイスは以下の通りである。

1. 式を因数分解し、\\( AB=0 \\color{green}{\\Leftrightarrow} A=0 \\lor B=0\\) を利用する。  
2. 2乗の差 \\(a^2-b^2=(a-b)(a+b)\\) を利用する。
3. 平方完成を行う。例：\\( (x-a)^2+b=0\\)。

## 平方根の計算を避ける

方程式の両辺の平方根をとってはいけない。
\\[ \\text{ If } a=b \\text{ then } a^2=b^2.\\]
しかし、
\\[ \\text{ if } a^2=b^2 \\text{ then } a=b \\text{ or } a=-b.\\]
つまり、\\(a^2=b^2\\) を \\(a=b\\) に変換するために両辺の平方根をとると、解を見落とす可能性がある。

この問題を避けるには、次のように*2乗の差*を利用する。

    a^2=b^2
    a^2-b^2=0
    (a-b)*(a+b)=0
    a=b or a=-b

\\[ \\begin{array}{ccc} \\  & a^2=b^2 & \\text{ } \\\\ \\color{green}{\\Leftrightarrow} & a^2-b^2=0 & \\text{ } \\\\ \\color{green}{\\Leftrightarrow} & \\left(a-b\\right) \\left(a+b\\right)=0 & \\text{ } \\\\ \\color{green}{\\Leftrightarrow} & a=b\\lor a=-b & \\text{ } \\end{array} \\]

## 特殊なケース

解が存在しない方程式がある場合もある。解がないことは、以下のいずれかの方法で表現できる。

1. `false`。計算の途中で \\(1=2\\) のような矛盾にたどり着くことがある。この方程式は偽であるため、計算の最終行に `false` と入力できる。
2. `none`。特別なキーワード `none` は、方程式を満たす変数の値が存在しないことを示すために使用される。
3. `{}`。空集合は、解が存在しないことを示す。

\\(x=x\\) のように、すべての数が解となる方程式もある。すべての数が解であることは、以下のいずれかの方法で表現できる。

1. `true`。計算の途中で \\(x=x\\) のような恒等式にたどり着くことがある。この方程式は真であるため、計算の最終行に `true` と入力できる。
2. `all`。特別なキーワード `all` は、任意の変数の値が方程式を満たすことを示すために使用される。
