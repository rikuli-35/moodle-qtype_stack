# オプション

オプションは各問題の動作に影響を与える。

### 簡略化（問題全体）

[簡略化](../CAS/Simplification.md)のエントリを参照できる。デフォルトは`true`である。

### 正と仮定 {#Assume_Positive}

このオプションは、[Maxima](../CAS/Maxima_background.md)の

    assume_pos

変数の値を設定する。

`true`の場合、現在のコンテキストやその他の考慮事項からパラメータ\(x\)の符号を決定できないとき、`sign`および`asksign(x)`は`true`を返す。これにより、`integrate`やその他の計算で発生するような、自動生成される`asksign`の問い合わせを抑制できる場合がある。

デフォルトはFalseである。

### 減点 {#Question_penalty}

これは、減点修正方式が使用されている場合に、完全に正しくない各有効試行から差し引かれる得点の割合である。デフォルトは、この問題で取得可能な得点の\(10\%\)であり、\(0.1\)と入力する。

Moodleは得点を小数点以下7桁まで保存するため、\(1/3\)は\(0.3333333\)と入力すること。\(1/3\)に近いが精度が低い数値を入力した場合、自動的に桁数が追加される。具体的には、\(\ge 0.33\)かつ\(\le 0.34\)の減点は\(0.3333333\)に変更され、\(\ge 0.66\)かつ\(\le 0.67\)の減点は\(0.6666667\)に変更される。

## 出力

以下のオプションは数式の表示方法に影響する。

### 小数点区切り {#decimals}

学生の入力で使用する小数点区切り記号を選択すること。現在2つの選択肢がある。

* `.`：イギリス式の小数点。
* `,`：コンマ。ヨーロッパの多くの国で使用されている。

このオプションの設計については、[開発者ドキュメント](../Developer/Syntax_numbers.md)を参照できる。

教師は、テストケースの作成も含め、常に`.`を使用する厳密なMaxima構文を用いなければならない。

### 科学的表記の形式 {#scientificnotation}

科学的表記の表示形式を選択できる。

* '*10'の場合、\(3.14 \times 10^{3}\)と表示される。
* 'E'の場合、\(3.14 E^{3}\)と表示される。

### 積の記号 {#multiplication}

* （なし）、例：\(x\,(x+1)\)（式の中でLaTeXのスペース`\,`を使用）
* ドット、例：\(x\cdot(x+1)\)
* クロス、例：\(x\times (x+1)\)
* 数字のみ、例：\(3\times 5\, x\)
* スペース、例：\(x\ (x+1)\)（半角スペース` `を使用）

実際には、学生に何らかの積の記号を表示することは非常に有用である。
\[ xe^x \text{ と } x\,e^x\]
の違いは非常に微妙である。スペースの違いに気づいたであろうか。前者は`xe^x=(xe)^x`を意味し、後者は`x*e^x`を意味する。積の記号がないと、学生はかなり混乱するかもしれない。\(x\cdot e^x\)を使えば、この問題をきれいに解決できる。

内部的には、積の記号の表示はSTACKの関数`make_multsgn(ex)`で制御される。引数には文字列`"cross"`、`"dot"`、`"onum"`、`"space"`、`"none"`のいずれかを指定できる。これはセッションの途中で切り替えることができる。たとえば、次のようなCASTextを考えてみよう。

    デフォルト：{@a*b@}。
    クロスに切り替え：{@(make_multsgn("cross"), a*b)@}。
    クロスのまま：{@a*b@}。

式`(make_multsgn("cross"), a*b)`は、Maximaの`block`コマンドの省略形として括弧を使用している。つまり、最初の式`make_multsgn("cross")`が評価され、表示オプションをクロスに変更する。次に2番目の式が評価され、\(a\times b\)と表示される。新しいオプションは次の式でも保持される。

オプション`onum`の値は、数字の間にのみ積の記号を表示する。例えば、「なし」を指定した場合に\(3\, 5\, x\)と表示されるところが、\(3\times 5\, x\)と表示される。

`onum`オプションで使用される積の記号を制御する特別なアトムがある。ドットを使用したい場合は、以下のように定義する。

    texput(multsgnonlyfornumberssym, "\\cdot");

これを問題変数に追加する。

### 論理記号 {#logicsymbol}

論理記号の表示方法を設定する。値は「言語」（例：\(A \text{ and } B\)）または「記号」（例：\(A\land B\)）である。

### 平方根の記号 {#surd}

このオプションは、[Maxima](../CAS/Maxima_background.md)の

    sqrtdispflag

変数の値を設定する。falseの場合、接頭辞関数`sqrt(x)`は\(x^{1/2}\)と表示される。この設定は問題全体に対して適用され、1つの問題内で両方の表記を共存させることは困難である。問題全体で`simp:false`を設定する必要がある。

デフォルトでは、Maximaは\(\sqrt{}\)記号を好まない。内部表現が分数乗を優先するのは、非常に正当な理由がある。Maximaでは以下のようになる。

    (%i1) 4*sqrt(2);
    (%o1) 2^(5/2)
    (%i2) 6*sqrt(2);
    (%o2) 3*2^(3/2)

さらに、Maximaのセッションで以下を実行すると、

    simp:true;
    p:1+sqrt(x);
    ?print(p);

`p`の表示値は\(\sqrt{x}+1\)であるが、`p`の内部表現は以下のようになる。

    ((MPLUS SIMP) 1 ((MEXPT SIMP) $X ((RAT SIMP) 1 2))) 

これは、デフォルトでは`sqrt`と表示されているにもかかわらず、Maximaが内部的に`sqrt(x)`を`x^(1/2)`に変換していることを意味する。これは、表示形式（テキストやLaTeX）がMaximaの内部表現と一致しない例である。

本当に授業で\(\sqrt{}\)を使い続けたいであろうか。L.オイラーは著書『代数学の要素』の中で次のように述べている。

> \(\S 200\) したがって、現在使われているラジカル記号を完全に廃止し、先ほど説明した分数指数を代わりに用いてもよいだろう。
> しかし、我々はこれらの記号に長く慣れ親しんでおり、ほとんどの代数学の書物でそれらを目にするため、計算から完全に追放するのは適切ではないかもしれない。
> しかし、現在しばしば行われているように、別の表記法を採用する十分な理由もある。
> 実際、\(a^\frac12\)が\(a\)の平方根であることはすぐにわかる。なぜなら、\(a^\frac12\)の2乗、すなわち
> \(a^\frac12\)に\(a^\frac12\)を掛けたものは\(a^1\)、すなわち\(a\)に等しいからである。

初等数学の多くは、ある形式から別の形式への変換とその逆の操作を含む。これらの形式には重要な使い分けがある場合もある（例：二次関数の因数分解形や平方完成形）。しかし、これらの等価な形式が、*「明らかに問題の本質に対応している」*からではなく慣習的に使われていることもある。余談になるが…

STACKは\(n\)乗根関数`root(x,n)`を定義している。学生はこれを使用できるが、教師が問題変数等でこれを使用したい場合は、`x^(1/n)`に即座に評価されないようにするため、アポストロフィを前に付けて`'root(x,n)`と記述する必要がある。

### sqrt(-1) {#sqrt_minus_one}

Maximaでは`%i`は`%i^2=-1`を満たす複素単位である。しかし、学生は`i`と入力したいと思うであろうし、物理学者やエンジニアは`j`と入力したいと思うであろう。また、ベクトルに対して記号`i`や`j`を使用する必要がある場合もある。これらのニーズに対応するために、`ComplexNo`というオプションがあり、これらの記号のコンテキストと表示方法を制御する。

| Option   | Interpretation   | Display   | ~     | ~    | ~     | ~
| -------- | ---------------- | --------- | ----- | ---- | ----- | -----
|          | %i^2             | i^2       | j^2   | %i   | i     | j
| -------- | ---------------- | --------- | ----- | ---- | ----- | -----
| i        | -1               | -1        | j^2   | i    | i     | _j_
| j        | -1               | i^2       | -1    | j    | _i_   | j
| symi     | -1               | i^2       | j^2   | i    | _i_   | _j_
| symj     | -1               | i^2       | j^2   | j    | _i_   | _j_

この表では、ローマン体とイタリック体の両方の記号が使われていることに注意する。

基底ベクトルとして\(i, j, k\)を使用する場合は、問題変数で以下のように設定する。

    /* 以下は、問題のComplexNoオプションを"symi"に設定することを意味する。*/
    make_complexJ("symi");
    ordergreat(i,j,k);
    texput(i,"\\vec{i}");
    texput(j,"\\vec{j}");
    texput(k,"\\vec{k}");
    %_stack_preamble_end;
    /* 以下は例である。*/
    p:3*i+4*j+5*k;
    q:a*i+b*j+c*k;

すると、`p`と`q`の式はそれぞれ\[{3\cdot \vec{i}+4\cdot \vec{j}+5\cdot \vec{k}}\]と\[{a\cdot \vec{i}+b\cdot \vec{j}+c\cdot \vec{k}}\]と表示される。
その他の例は[ベクトル](../CAS/Matrix.md#vectors)のドキュメントに記載されている。

### 行列の括弧

[行列](../CAS/Matrix.md#matrixparens)のエントリを参照のこと。

### インライン分数と表示分数

分数を表示するには3つの方法がある。

1. 表示（ディスプレイ）分数：\( \frac{1}{x} \)
2. インライン分数：\( 1/x \)
3. 負のべき乗表示：\( x^{-1} \)

デフォルトの動作は表示（ディスプレイ）であり、LaTeXの`\frac{}{}`を使用する。

関数`stack_disp_fractions(ex)`を使用すると、問題内でグローバルに表示を制御できる。

* `stack_disp_fractions("i")`は表示をインラインに切り替える。
* `stack_disp_fractions("d")`は表示をディスプレイに切り替える。

注意：CASTextでは、変数が問題変数で定義された時点ではなく、テキストが表示される時点での設定によって表示が制御される。したがって、CASText内に1つだけインライン分数を表示したい場合は、以下のように記述する必要がある。

    通常、分数は{@1/x@}と表示される。これはインライン{@(stack_disp_fractions("i"), 1/x)@}に切り替わり、{@1/a@}でも持続する。明示的に表示に戻す{@(stack_disp_fractions("d"),1/x)@}。  

科学的な単位については、学生の入力を負のべき乗で表示するための解答欄の「その他のオプション」`negpow`もある（例：\(m\,s^{-1}\)）。

現在のところ、負のべき乗を使用した分数のグローバル表示はサポートしていない（2024年12月時点）。これは、表示分数とインライン分数の違いが純粋に表記上のものであり、除算演算子からのTeX出力に関わるためである。除算を負のべき乗に変換するのは数学的な書き換えルールであるため、かなり複雑になる。たとえば、\( \frac{1}{x^{-2}} \)をどのように表示するかを決定する必要がある。
