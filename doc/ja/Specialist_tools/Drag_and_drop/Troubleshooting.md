# トラブルシューティング

このページでは、パーソンズ問題のトラブルシューティングに関するアドバイスを提供する。

マッチング問題が正しく表示されない場合、特にすべてのアイテムが1つの黄色いブロックにまとめて表示される場合は、Parsonsブロック内のJSONのキーが以下の説明通りに正しく記述されているか再確認する。キーは以下の2つの要件を満たしている必要がある。

1. 次のキーの部分集合（サブセット）であること:
    {"steps", "options", "headers", "available_header", "index"}

2. かつ、以下の集合の上位集合（スーパーセット）であること:
    {"steps"}

技術的な理由により、現在このエラーをシステム側で自動的に検証することはできない。

## 状態（State）

問題の解答中の任意の時点における「状態」は、以下の形式をとる。

    {used: usedState, available: availableState}

ここで、`usedState` と `availableState` は、解答内のJSONの `steps` で指定されたキーを含む配列である。すべての場合において、`availableState` は可変長のフラットな一次元配列である。一方、`usedState` の形状は、使用するレイアウトによって異なる。

例えば次のような問題文がある場合、

1. **証明問題（Proof）**：この場合、`usedState` の形状は `(1, 1, ?)` となる（`?` は可変次元を示す）。例えば：

    [[parsons input="ans1"]]
    {
        "1":"Assume that \\(n\\) is odd.",
        "2":"Then there exists an \\(m\\in\\mathbb{Z}\\) such that \\(n=2m+1\\).",
        "3":"\\[ n^2 = (2m+1)^2 = 2(2m^2+2m)+1.\\]",
        "4":"Define \\(M=2m^2+2m\\in\\mathbb{Z}\\) then \\(n^2=2M+1\\).",
    }
[[/parsons]]

特定の時点における状態は、以下のようになる。

    {
        used : [
            [
                ["1", "3"]
            ]
        ]
        available : 
            ["2", "4"]
    }

2. **列グルーピング**：この場合、`usedState` の形状は `(n, 1, ?)` となる。ここで`n`は列数、`?` は可変の次元を示す。

例えば次のような問題文がある場合、

    [[parsons columns="2"]]
    {
        "f" : "\\(y = x^2\\)",
        "g" : "\\(y = x^3\\)",
        "quad" : "Quadratic",
        "cubic" : "Cubic",
    }
    [[/parsons]]

ある時点で、状態は次のようになることがある。

{
    used : [
        [
            ["f"]
        ],
        [
            ["quad", "cubic"]
        ]
    ],
    available : ["g"]
}

1. **行グルーピング**：この場合、`usedState` の形状は `(m, 1, ?)` となる。ここで`m`は行数、`?` は可変の次元を示す。**行グルーピング**の状態形式は、`m` と `n` が同じ値の場合、**列グルーピング**と同じ形式になる。

2. **グリッド**：この場合、`usedState` の形状は `(n, m, 1)` となる。ここで`n`は列数、`m`は行数を示す。

例えば次のような問題文がある場合

    [[parsons columns="2" rows="3"]]
    {
        "f" : "\\(y = x^2\\)",
        "g" : "\\(y = x^3\\)",
        "h" : "\\(y = x^4\\)",
        "quad" : "Quadratic",
        "cubic" : "Cubic",
        "quart" : "Quartic"
    }
    [[/parsons]]

ある時点で、状態は次のようになることがある。

    {
        used : [
            [
                ["f"],
                ["g"],
                [],
        ],
            [
                ["quad"],
                [],
                ["quart"]
            ]
        ],
        available : ["h", "cubic"]
    }
